<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.tripleaims.exhibition.dao.ExhibitionDAO">

	<select id="selectExhibition" resultType="ExhibitionDTO">
		SELECT * FROM EXHIBITION_VIEW
		<where>
			<if test="title != null and title != ''">
				TITLE LIKE CONCAT('%',#{title},'%')
			</if>
			<if test="toDate != null">
				AND START_DATE &gt; #{toDate}
			</if>
			<if test="endDate != null">
				AND START_DATE &lt; #{endDate}
			</if>
			AND DELETE_YN = 'N'
		</where>
	</select>

	<select id="selectMaxExhibitionNo" resultType="java.lang.String">
		SELECT MAX(EXHIBITION_NO) FROM EXHIBITION
	</select>

	<insert id="insertExhibition" parameterType="ExhibitionDTO">
		INSERT INTO EXHIBITION (`EXHIBITION_NO`, `TITLE`, `CONTENT`, `ARTIST_NO`, `START_DATE`, `REG_DATE`, `EDIT_DATE`)
		VALUES (#{exhibitionNo}, #{title}, #{content}, #{artistNo}, #{startDate}, NOW(), NOW())
	</insert>

	<insert id="insertExhibitionArtwork" parameterType="ExhibitionArtworkDTO">
		INSERT INTO EXHIBITION_ARTWORK (`EXHIBITION_ARTWORK_NO`, `EXHIBITION_NO`, `ARTWORK_NO`, `ORDER_NO`, `REG_DATE`)
		VALUES (#{exhibitionArtworkNo}, #{exhibitionNo}, #{artworkNo}, #{orderNo}, NOW())
	</insert>

	<select id="exhibitionInfo"  parameterType="java.lang.String" resultType="com.tripleaims.exhibition.dto.ExhibitionDTO">
		SELECT EXHIBITION_NO, TITLE, CONTENT, ARTIST_NO, START_DATE, OPEN_YN, SHOW_YN, DELETE_YN, REG_DATE, EDIT_DATE, HIT
		FROM exhibition
		WHERE EXHIBITION_NO=#{exhibitionNo}
	</select>
	
	<select id="exhibitionList"  parameterType="com.tripleaims.exhibition.dto.ExhibitionDTO" resultType="com.tripleaims.exhibition.dto.ExhibitionDTO">
		SELECT * FROM exhibition
		WHERE OPEN_YN =#{openYn} AND SHOW_YN = 'Y'
	</select>

	<select id="exArtwowrk" parameterType="java.lang.String" resultType="com.tripleaims.exhibition.dto.ArtworkDTO">
		SELECT e.EXHIBITION_NO, e.ARTWORK_NO, e.ORDER_NO, a.TITLE, a.MAIN_THUM1_NAME, a.SELL_VALUE, a.`EXPLAIN`
		FROM exhibition_artwork e, artwork_view a
		WHERE e.ARTWORK_NO= a.ARTWORK_NO AND e.EXHIBITION_NO =#{exhibitionNo} AND a.SHOW_YN = 'Y' AND a.DELETE_YN = 'N'
		ORDER BY e.ORDER_NO ASC
	</select>






</mapper>